import string
import uuid

import faker


def random_bin_file(hostname: str):
    fake = faker.Faker()

    # Local MAC/IP
    lmac = fake.mac_address()
    lip = fake.ipv4_private()
    lipv6 = fake.ipv6()

    # Local gateway etc.
    lip_h, _, _ = lip.rpartition(".")
    lgw = f"{lip_h}.0"
    lmx = f"{lip_h}.255"

    # Function aliases for brevity
    mac = lambda x: fake.mac_address().replace(":", x) if x is not None else fake.mac_address()
    c = lambda a, b: a if fake.boolean() else b
    yn = lambda: c("Yes", "No")

    # DHCP enabled y/n
    dhcp = yn()

    # Hotfixes
    n_hotfix = fake.random_int(2, 18)
    hotfixes = ""
    for i in range(n_hotfix):
        hotfixes += f"                               [{i:0>2}]: KB{fake.random_number(7)}\r\n"

    # Let's go!
    return f"""
FILEBEGIN
===========================================================================
Interface List
 11...{mac(" ")} ......Intel(R) PRO/1000 MT Desktop Adapter
  1...........................Software Loopback Interface 1
 12...00 00 {mac(" ")} Microsoft ISATAP Adapter
 13...00 00 {mac(" ")} Teredo Tunneling Pseudo-Interface
===========================================================================

IPv4 Route Table
===========================================================================
Active Routes:
Network Destination        Netmask          Gateway       Interface  Metric
          0.0.0.0          0.0.0.0  {lgw:>15}  {lip:>15}     11
        127.0.0.0        255.0.0.0         On-link         127.0.0.1    306
        127.0.0.1  255.255.255.255         On-link         127.0.0.1    306
  127.255.255.255  255.255.255.255         On-link         127.0.0.1    306
  {lgw:>15}    255.255.255.0         On-link   {lip:>15}    266
  {lip:>15}  255.255.255.255         On-link   {lip:>15}    266
  {lmx:>15}  255.255.255.255         On-link   {lip:>15}    266
        224.0.0.0        240.0.0.0         On-link         127.0.0.1    306
        224.0.0.0        240.0.0.0         On-link   {lip:>15}    266
  255.255.255.255  255.255.255.255         On-link         127.0.0.1    306
  255.255.255.255  255.255.255.255         On-link   {lip:>15}    266
===========================================================================
Persistent Routes:
  Network Address          Netmask  Gateway Address  Metric
          0.0.0.0          0.0.0.0  {lip:>15}       1
===========================================================================

IPv6 Route Table
===========================================================================
Active Routes:
 If Metric Network Destination      Gateway
  1    306 ::1/128                  On-link
 11    266 fe80::/64                On-link
  1    266 fe80::{fake.hexify("^^^^:^^^^:^^^^:^^^^")}/128
                                    On-link
  1    306 ff00::/8                 On-link
 11    266 ff00::/8                 On-link
===========================================================================
Persistent Routes:
  None

Host Name:                 {hostname}
OS Name:                   Microsoft Windows 7 Home Premium 
OS Version:                6.1.7601 Service Pack 1 Build 7601
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Workstation
OS Build Type:             Multiprocessor Fr e
Registered Owner:          {fake.bothify("?###???", letters=string.ascii_uppercase)}
Registered Organization:   
Product ID:                {fake.bothify("?????-???-???????-?????")}
Original Install Date:     {fake.date_between("-5y"):"%-m/%-d/%Y, %H:%M:%S %p"}
System Boot Time:          {fake.date_between("-5y"):"%-m/%-d/%Y, %H:%M:%S %p"}
System Manufacturer:       {fake.lexify("????????????")}
System Model:              {fake.lexify("??????????")}
System Type:               X86-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: x86 Family 21 Model 1 Stepping 2 AuthenticAMD ~{fake.random_int(500, 3600)} Mhz
BIOS Version:              {fake.lexify("????????????")} {fake.lexify("????????")}, {fake.date("%m/%d/%Y")}
Windows Directory:         C:\\Windows
System Directory:          C:\\Windows\\system32
Boot Device:               \\Device\\HarddiskVolume1
System Locale:             en-us;English (United States)
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC{fake.random_int(-11, 11):+3d}:00) Pacific Time ({fake.timezone()})
Total Physical Memory:     {fake.random_int(256, 32768):,d} MB
Available Physical Memory: {fake.random_int(256, 32768):,d} MB
Virtual Memory: Max Size:  {fake.random_int(256, 32768):,d} MB
Virtual Memory: Available: {fake.random_int(256, 32768):,d} MB
Virtual Memory: In Use:    {fake.random_int(128, 16384):,d} MB
Page File Location(s):     C:\\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              \\\\{fake.lexify("??????????")}
Hotfix(s):                 {n_hotfix} Hotfix(s) installed.
{hotfixes}
Network Card(s):           1 NIC(s) Installed.
                           [01]: Intel(R) PRO/1000 MT Desktop Adapter
                                 Connection Name: Local Area Connection
                                 DHCP Enabled:    {dhcp}
                                 IP address(es)
                                 [01]: {lip}
                                 [02]: {lipv6}

Interface: {lip} --- 0xz
  Internet Address      Physical Address      Type
  {lip:<15}       {lmac.replace(":", "-")}     {c("Static", "Dynamic")}   
  {lip_h}.{fake.random_number(2):<3}         {mac('-')}     {c("Static", "Dynamic")}   
  {lip_h}.{fake.random_number(2):<3}         {mac('-')}     {c("Static", "Dynamic")}   
  {lmx:<15}        {mac('-')}     {c("Static", "Dynamic")}    
  224.0.0.22            {mac('-')}     {c("Static", "Dynamic")}    
  224.0.0.252           {mac('-')}     {c("Static", "Dynamic")}    

Windows IP Configuration

   Host Name . . . . . . . . . . . . : {hostname}
   Primary Dns Suffix  . . . . . . . : 
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : {yn()}
   WINS Proxy Enabled. . . . . . . . : {yn()}

Ethernet adapter Local Area Connection:

   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Intel(R) PRO/1000 MT Desktop Adapter
   Physical Address. . . . . . . . . : {lmac.replace(":", "-").upper()}
   DHCP Enabled. . . . . . . . . . . : {dhcp}
   Autoconfiguration Enabled . . . . : {yn()}
   Link-local IPv6 Address . . . . . : {lipv6}%11(Preferred) 
   IPv4 Address. . . . . . . . . . . : {lip}(Preferred) 
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : {lgw}
   DHCPv6 IAID . . . . . . . . . . . : {fake.random_number(9)}
   DHCPv6 Client DUID. . . . . . . . : 00-00-00-01-{fake.hexify(text='^^-^^-^^-^^-^^-^^-^^-^^-^^-^^', upper=True)}
   DNS Servers . . . . . . . . . . . : 8.8.8.8
   NetBIOS over Tcpip. . . . . . . . : {c("Enabled", "Disabled")}

Tunnel adapter isatap.{"{" + str(uuid.uuid1()) + "}"}:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Microsoft ISATAP Adapter
   Physical Address. . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP Enabled. . . . . . . . . . . : {yn()}
   Autoconfiguration Enabled . . . . : {yn()}

Tunnel adapter Teredo Tunneling Pseudo-Interface:

   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Teredo Tunneling Pseudo-Interface
   Physical Address. . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP Enabled. . . . . . . . . . . : {yn()}
   Autoconfiguration Enabled . . . . : {yn()}
There are no entries in the list.


Local Area Connection:
Node IpAddress: [{lip}] Scope Id: []

    No names in cache
There are no entries in the list.


FILEEND
"""


if __name__ == "__main__":
    print(random_bin_file("THESIS"))
