import ipaddress
from datetime import datetime
from typing import Union


class bcolors:
    """Source: Data Exfiltration Toolkit (DET) @PaulWebSec"""
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'


def display_message(message):
    """Source: Data Exfiltration Toolkit (DET) @PaulWebSec"""
    print(f"[{datetime.now():%Y-%m-%d %H:%M:%S}] {message}")


def error(message):
    display_message("%s%s%s" % (bcolors.FAIL, message, bcolors.ENDC))


def warning(message):
    """Source: Data Exfiltration Toolkit (DET) @PaulWebSec"""
    display_message("%s%s%s" % (bcolors.WARNING, message, bcolors.ENDC))


def ok(message):
    """Source: Data Exfiltration Toolkit (DET) @PaulWebSec"""
    display_message("%s%s%s" % (bcolors.OKGREEN, message, bcolors.ENDC))


def info(message):
    """Source: Data Exfiltration Toolkit (DET) @PaulWebSec"""
    display_message("%s%s%s" % (bcolors.OKBLUE, message, bcolors.ENDC))


def validate_ip(ip: str) -> str:
    ip = ipaddress.ip_address(ip)
    return str(ip)


def validate_port(port: Union[str, int]) -> int:
    port = int(port)
    if port < 1 or port > 65535:
        raise ValueError("Invalid port in server config.")
    return port
