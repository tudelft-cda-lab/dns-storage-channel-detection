import sys
from typing import Dict, Any

from config_parser import parse_client_config
from util import error


class Client:
    def __init__(self, config: Dict[str, any]):
        self.config = _validate_client_config(config)

        # Load malware client
        self.client = parse_client_config(config)

    def start(self):
        self.client.start()


def _validate_client_config(config: Dict[Any, Any]) -> Dict[Any, Any]:
    if not config:
        error("[Client] No configuration file provided.")
        sys.exit(-1)

    if "client" not in config:
        error("[Client] Client section missing in configuration file.")
        sys.exit(-1)

    return config
